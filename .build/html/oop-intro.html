

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Class reference &mdash; Lide SDK 0.0.01 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Lide SDK 0.0.01 documentation" href="index.html"/>
        <link rel="next" title="Encapsulación y modificadores de acceso" href="access_modifiers.html"/>
        <link rel="prev" title="Welcome" href="welcome.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Lide SDK
          

          
          </a>

          
            
            
              <div class="version">
                0.0.01
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="welcome.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="welcome.html#how-to-use-it">How to use it</a></li>
</ul>
<p class="caption"><span class="caption-text">OOP Model</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Class reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#making-a-class">Making a class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-our-class">Defining our class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constructor">Constructor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lua-events-meta-methods">Lua events (meta-methods)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instantiation">Instantiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#classes-methods">Classes methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running">Running</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#intance-s-methods">Intance&#8217;s methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-variables">Static variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#virtual-methods">Virtual Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#private-attributes">Private attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#castings">Castings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access_modifiers.html">Encapsulación y modificadores de acceso</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Lide SDK</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Class reference</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/oop-intro.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="class-reference">
<h1>Class reference<a class="headerlink" href="#class-reference" title="Permalink to this headline">¶</a></h1>
<p>A tutorial mode, this paper will try to explain what OOP in Lide programming and adaptations made in
the base language (Lua) so that the programmer can design and implement their own classes or even
modify aspects of Lide framework.</p>
<p>Within the world of LUA are different implementations/adaptations of OOP, some are shaped and other
projects are simple scripts that help us interact with classes, subclasses, methods and properties
within the programming language.</p>
<p>For various reasons we decided to take a small but highly customizable and scalable library that
suits our needs as a project, such implementation was called <a class="reference external" href="http://lua-users.org/wiki/YetAnotherClassImplementation">yaci.lua</a>
(for <a class="reference external" href="https://github.com/jpatte">Julien Patte</a>) we include it within the core and made some minor
modifications to be adequate to what we wanted.</p>
<div class="section" id="making-a-class">
<h2>Making a class<a class="headerlink" href="#making-a-class" title="Permalink to this headline">¶</a></h2>
<p>Basically there are two ways to define a new class:</p>
<p>Calling th function <code class="docutils literal"><span class="pre">newclass()</span></code> or using the method <code class="docutils literal"><span class="pre">BaseObject:subclass()</span></code></p>
<p>When you are creating a class must specify a name for it, this is not absolutely necessary, but can
be helpful at the time of debug their applications. <strong>If you do not specify the class name will be
called &#8220;Unnamed&#8221;.</strong></p>
<p>When you use <code class="docutils literal"><span class="pre">Object:subclass()</span></code>, the new class will be directly a subclass of <a class="reference internal" href="classes/object.html#classobject"><span class="std std-ref">Object</span></a>
on the other hand <code class="docutils literal"><span class="pre">newClass()</span></code> accepts a second argument, which will be another superclass for your
object if you do not specify a superclass, the <a class="reference internal" href="classes/object.html#classobject"><span class="std std-ref">Object class</span></a> will be chosen.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This means that all classes are subclasses of <a class="reference internal" href="classes/object.html#classobject"><span class="std std-ref">Object</span></a>.</p>
</div>
<p>An example can illustrate better:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="c1">-- &#39;Human&#39; is a subclass of &#39;BaseObject&#39;</span>
<span class="n">Human</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">Human&quot;</span><span class="p">)</span>
<span class="c1">-- &#39;Engineer&#39; is a subclass of &#39;Human&#39;</span>
<span class="n">Engineer</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">Engineer&quot;</span><span class="p">,</span> <span class="n">Human</span><span class="p">)</span>
<span class="c1">-- &#39;Student&#39; is another subclass of &#39;Human&#39;</span>
<span class="n">Student</span> <span class="o">=</span> <span class="n">Human</span><span class="p">:</span><span class="n">subclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">Student&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-our-class">
<h2>Defining our class<a class="headerlink" href="#defining-our-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="constructor">
<h3>Constructor<a class="headerlink" href="#constructor" title="Permalink to this headline">¶</a></h3>
<p>Naturally our classes can define a constructor, or not ...
How to define our builders is as follows:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="nf">Human</span><span class="p">:</span><span class="n">Human</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
     <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
     <span class="n">self</span><span class="p">.</span><span class="n">year</span>   <span class="o">=</span> <span class="n">year</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">Engineer</span><span class="p">:</span><span class="n">Engineer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">super</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>   <span class="c1">--&gt; Note that this calls the superclass constructor</span>
    <span class="n">self</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Subclasses can call the constructor of its superclasses through the field super <code class="docutils literal"><span class="pre">self.super:init()</span></code>.
Note that <code class="docutils literal"><span class="pre">Object:init()</span></code> there however, it is recommended never to use it.</p>
</div>
</div>
<div class="section" id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<p>Methods can be defined in a very simple way:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span>function Human:Greet()
    print(“Hello World”)
end
function Engineer:Read( book )
    print(&quot;Reading: ”..book)
end
</pre></div>
</div>
</div>
<div class="section" id="lua-events-meta-methods">
<h3>Lua events (meta-methods)<a class="headerlink" href="#lua-events-meta-methods" title="Permalink to this headline">¶</a></h3>
<p>Do not confuse these events with the <em>class Event</em> These events correspond to interactions between
objects in the programming language, some of these may be: <code class="docutils literal"><span class="pre">__tostring</span></code>, <code class="docutils literal"><span class="pre">__add</span></code>, <code class="docutils literal"><span class="pre">__eq</span></code>.</p>
<p>For more information on methods and meta-meta-tables in Lua see the language reference.</p>
<p>Usted también puede definir eventos para las instancias de la clase, exactamente de la misma manera que define los métodos:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span>function Human:__tostring ()
    return “a Human called: ” .. self.nombre .. “, have “ .. self.edad .. “ years old.”
end

function Engineer:__tostring()
    return “A Engineer of “.. self.titulo .. “ called: ” .. self.nombre .. “, have “ .. self.edad .. “ years old.”
end
</pre></div>
</div>
<p>Any event can be used, except and <code class="docutils literal"><span class="pre">__newindex</span></code> <code class="docutils literal"><span class="pre">__index</span></code> which are necessary for the operation
of the library.</p>
<p>You can use this feature to define operators as <code class="docutils literal"><span class="pre">__add</span></code>, <code class="docutils literal"><span class="pre">__eq</span></code>, etc. <code class="docutils literal"><span class="pre">__tostring</span></code> is a really
useful event class <a class="reference internal" href="classes/object.html#classobject"><span class="std std-ref">Object</span></a> implements a standard version it simply returns &#8220;xxx&#8221;
where &#8216;xxx&#8217; is the name of the class of that instance.</p>
</div>
<div class="section" id="instantiation">
<h3>Instantiation<a class="headerlink" href="#instantiation" title="Permalink to this headline">¶</a></h3>
<p>Every class has the <code class="docutils literal"><span class="pre">new()</span></code> method, used for instantiation. All the arguments we pass to this
method are passed to the constructor:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span>Anthony = Human:new (“Anthony”, 33)
Camila  = Engineer:new (“Camila”, 21, “Electrónica”)
</pre></div>
</div>
<p>The result is the same as if you &#8220;called&#8221; classes directly:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span>Julieth = Human (“Julieth”, 13)
Jefferson = Engineer (“Jefferson”, 23, “Sistemas”)
</pre></div>
</div>
</div>
<div class="section" id="classes-methods">
<h3>Classes methods<a class="headerlink" href="#classes-methods" title="Permalink to this headline">¶</a></h3>
<p>As <code class="docutils literal"><span class="pre">subclass()</span></code> and <code class="docutils literal"><span class="pre">new()</span></code>, classes have some other methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">inherits()</span></code> It can be used to check if a class inherits from another class:
For example: <code class="docutils literal"><span class="pre">Ingeniero:inherits(Humano)</span></code> returns <code class="docutils literal"><span class="pre">true</span></code>, and <code class="docutils literal"><span class="pre">Estudiante:inherits(Ingeniero)</span></code> returns <code class="docutils literal"><span class="pre">false</span></code>. (Generally used for internal purposes)</li>
<li><code class="docutils literal"><span class="pre">name()</span></code> Returns the name of the class (you specified when you created it).</li>
<li><code class="docutils literal"><span class="pre">super()</span></code> Returns the superclass.</li>
<li><code class="docutils literal"><span class="pre">made()</span></code> It is used to check if an instance implements this class or not.
For example, <code class="docutils literal"><span class="pre">Human:made(Anthony)</span></code> returns <code class="docutils literal"><span class="pre">true</span></code> While <code class="docutils literal"><span class="pre">Student:made(Jefferson)</span></code> returns <code class="docutils literal"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal"><span class="pre">virtual()</span></code> It is used to explicitly declare abstract and virtual methods, see below.</li>
<li><code class="docutils literal"><span class="pre">cast()</span></code> &amp; <code class="docutils literal"><span class="pre">trycast()</span></code> they are used for casting. See below for details.</li>
</ul>
</div>
</div>
<div class="section" id="running">
<h2>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h2>
<div class="section" id="intance-s-methods">
<h3>Intance&#8217;s methods<a class="headerlink" href="#intance-s-methods" title="Permalink to this headline">¶</a></h3>
<p>All instances allow access to variables defined in the constructor of your class (and its superclasses).
They also have a <code class="docutils literal"><span class="pre">class()</span></code> method that returns the class, and <code class="docutils literal"><span class="pre">super</span></code> field that is used to access
the superclass if you overwrote the method, see:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">test</span><span class="p">()</span> <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> <span class="k">end</span>
<span class="n">A</span><span class="p">:</span><span class="n">virtual</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">test&quot;</span><span class="p">)</span> <span class="c1">-- declare test() as being virtual; see below</span>
<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="n">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="k">end</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">B&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">test</span><span class="p">()</span> <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">a</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="s">+&quot;</span> <span class="o">..</span> <span class="n">self</span><span class="p">.</span><span class="n">b</span><span class="p">)</span> <span class="k">end</span>
<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="n">self</span><span class="p">.</span><span class="n">super</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">self</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="k">end</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">b</span><span class="p">:</span><span class="n">test</span><span class="p">()</span>         <span class="c1">-- prints &quot;5+3&quot;</span>
<span class="n">b</span><span class="p">.</span><span class="n">super</span><span class="p">:</span><span class="n">test</span><span class="p">()</span>   <span class="c1">-- prints &quot;5&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">a</span><span class="p">)</span>       <span class="c1">-- prints &quot;5&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">super</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> <span class="c1">-- prints &quot;5&quot;</span>
</pre></div>
</div>
<p>Superclass members are created (and initialized) when the <code class="docutils literal"><span class="pre">self.super:init()</span></code> is called. You generally
must call this method at the beginning of the constructor to initialize. Note that b is an instance
of <code class="docutils literal"><span class="pre">B</span></code>, <code class="docutils literal"><span class="pre">b.super</span></code> is simply an instance of <code class="docutils literal"><span class="pre">A</span></code> (then beware, here <code class="docutils literal"><span class="pre">super</span></code> is dynamic, not static).</p>
</div>
<div class="section" id="static-variables">
<h3>Static variables<a class="headerlink" href="#static-variables" title="Permalink to this headline">¶</a></h3>
<p>Every time you define a new method for a class, it is recorded in a table <code class="docutils literal"><span class="pre">static</span></code>; in this way we
will not mix the methods of classes with class services. This table is accessible via the <code class="docutils literal"><span class="pre">static</span></code>
field. This generally allows access to static variables in classes, for example:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="n">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="k">end</span>
<span class="n">A</span><span class="p">.</span><span class="n">test</span> <span class="o">=</span> <span class="mi">5</span>   <span class="c1">-- a static variable in A</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">prints</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">)</span>           <span class="c1">-- prints 3</span>
<span class="n">prints</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">test</span><span class="p">)</span>        <span class="c1">-- prints 5</span>
<span class="n">prints</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">test</span><span class="p">)</span>        <span class="c1">-- prints nil (!)</span>
<span class="n">prints</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">static</span><span class="p">.</span><span class="n">test</span><span class="p">)</span> <span class="c1">-- prints 5</span>
</pre></div>
</div>
</div>
<div class="section" id="virtual-methods">
<h3>Virtual Methods<a class="headerlink" href="#virtual-methods" title="Permalink to this headline">¶</a></h3>
<p>The class methods are not virtual by default, which means implicitly that they are not overwritten
by potential implementations of subclasses. To declare a method as virtual you have to declare explicitly
using the <code class="docutils literal"><span class="pre">virtual()</span></code> in its class. The call to <code class="docutils literal"><span class="pre">virtual()</span></code> should be written out of any method,
and before the method definition:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">whoami</span><span class="p">()</span>
  <span class="k">return</span> <span class="s2">&quot;</span><span class="s">A&quot;</span>
<span class="k">end</span>
<span class="n">A</span><span class="p">:</span><span class="n">virtual</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">whoami&quot;</span><span class="p">)</span> <span class="c1">-- whoami() is declared virtual</span>

<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">test</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">:</span><span class="n">whoami</span><span class="p">())</span>
<span class="k">end</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">B&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">whoami</span><span class="p">()</span>
  <span class="k">return</span> <span class="s2">&quot;</span><span class="s">B&quot;</span>
<span class="k">end</span>
  <span class="c1">-- no need to use B:virtual() here</span>
<span class="n">myB</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="n">myB</span><span class="p">:</span><span class="n">test</span><span class="p">()</span> <span class="c1">-- prints &quot;B&quot;</span>
</pre></div>
</div>
<p>With this it is also possible to declare some methods as abstract (b.p. purely virtual methods); you
just call <code class="docutils literal"><span class="pre">A:virtual()</span></code> with the method name without defining it.</p>
<p>An error will occur if you try to call without defining it before in the hierarchy.</p>
<p>Example here:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>

<span class="n">A</span><span class="p">:</span><span class="n">virtual</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">whoami&quot;</span><span class="p">)</span> <span class="c1">-- whoami() is an abstract method</span>

<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">test</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">:</span><span class="n">whoami</span><span class="p">())</span>
<span class="k">end</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">B&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">whoami</span><span class="p">()</span> <span class="c1">-- define whoami() here</span>
  <span class="k">return</span> <span class="s2">&quot;</span><span class="s">B&quot;</span>
<span class="k">end</span>

<span class="n">myB</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="n">myB</span><span class="p">:</span><span class="n">test</span><span class="p">()</span> <span class="c1">-- will print &quot;B&quot;</span>

<span class="n">myA</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>  <span class="c1">-- no error here!</span>
<span class="n">myA</span><span class="p">:</span><span class="n">test</span><span class="p">()</span> <span class="c1">-- but will raise an error here</span>
</pre></div>
</div>
</div>
<div class="section" id="private-attributes">
<h3>Private attributes<a class="headerlink" href="#private-attributes" title="Permalink to this headline">¶</a></h3>
<p>By default, subclasses inherit all methods and all the attributes defined by their (s) type (s) father.
This can lead to some confusion when defining attributes that share the same name at different levels
in the hierarchy:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">init</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>  <span class="c1">-- define an attribute here for internal purposes</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">doSomething</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1">-- change attribute value</span>
  <span class="c1">-- do something here...</span>
<span class="k">end</span>


<span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="p">:</span><span class="n">subclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">B&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">super</span><span class="p">:</span><span class="n">init</span><span class="p">()</span>   <span class="c1">-- call the superclass&#39;s constructor</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>          <span class="c1">-- B defines an &#39;x&#39; attribute. Problem: &#39;x&#39; is actually already defined by A!</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">doYourJob</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">self</span><span class="p">.</span><span class="n">doSomething</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>       <span class="c1">-- prints &quot;0&quot;: &#39;x&#39; has been modified by A because A defined it first</span>
<span class="k">end</span>
</pre></div>
</div>
<p>You can define private attributes in a class depending on the order in which these attributes are initialized.</p>
<p>Note that &#8220;private&#8221; is not the best term to describe it here (because this is not a real protection
mechanism); I prefer to speak of attribute &#8220;shared&#8221; and &#8220;shared&#8221; between classes and subclasses.</p>
<p>You will also notice that this distinction is made by the same subclass (and not by the superclass),
which can decide (in its constructor) which attributes of the superclass can be possibly inherited from
the superclass or overwritten privately.</p>
<p>By law, you almost always define the attributes of the class before calling the constructor of its superclass.</p>
<p>Let&#8217;s see this example with a small change in <code class="docutils literal"><span class="pre">B:init()</span></code>:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">init</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>  <span class="c1">-- define an attribute here for internal purposes</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">doSomething</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1">-- change attribute value</span>
  <span class="c1">-- do something here...</span>
<span class="k">end</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="p">:</span><span class="n">subclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">B&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>          <span class="c1">-- B defines a private &#39;x&#39; attribute</span>
  <span class="n">self</span><span class="p">.</span><span class="n">super</span><span class="p">:</span><span class="n">init</span><span class="p">()</span>   <span class="c1">-- call the superclass&#39;s constructor</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">doYourJob</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">self</span><span class="p">.</span><span class="n">doSomething</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>       <span class="c1">-- prints &quot;5&quot;: &#39;x&#39; has not been modified by A</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">super</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="c1">-- prints &quot;0&quot;: this is the &#39;x&#39; attribute that was used by A</span>
<span class="k">end</span>
</pre></div>
</div>
<p>As you can see the different behaviors of the attributes <code class="docutils literal"><span class="pre">X</span></code> and <code class="docutils literal"><span class="pre">Y</span></code> come in the order of
initialization in the constructor.</p>
<p>The first class that defines an attribute will obtain possession of that attribute, even if some
superclasses declare an attribute with the same name &#8220;after&#8221; in the initialization process.</p>
<p>I personally suggest initialize all attributes &#8220;unshared&#8221; the beginning of the constructor, then call
the superclass constructor, then a Eventually use some of the superclass&#8217; methods. On the contrary
if you want to access an attribute defined by a superclass does not set this value before the
superclass constructor has done it.</p>
</div>
<div class="section" id="castings">
<h3>Castings<a class="headerlink" href="#castings" title="Permalink to this headline">¶</a></h3>
<p>The Castings are very useful if you need access to a (non-virtual) method from a localized higher in
the class hierarchy method. This can be done with the <code class="docutils literal"><span class="pre">cast()</span></code> and <code class="docutils literal"><span class="pre">trycast()</span></code> of all kinds.</p>
<p>Here&#8217;s a simple example:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">A&quot;</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">A</span><span class="p">:</span><span class="n">foo</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>         <span class="c1">-- prints &quot;nil&quot;! There is no field &#39;x&#39; at A&#39;s level</span>
  <span class="n">selfB</span> <span class="o">=</span> <span class="n">B</span><span class="p">:</span><span class="n">cast</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>  <span class="c1">-- explicit casting into a B</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">selfB</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>        <span class="c1">-- prints &quot;5&quot;</span>
<span class="k">end</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">newclass</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">B&quot;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">B</span><span class="p">:</span><span class="n">init</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
<span class="k">end</span>

<span class="n">myB</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">myB</span><span class="p">:</span><span class="n">foo</span><span class="p">()</span>
<span class="n">C</span><span class="p">:</span><span class="n">cast</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Try searching for the sub-object or super-object <code class="docutils literal"><span class="pre">x</span></code> corresponding to the <code class="docutils literal"><span class="pre">class</span> <span class="pre">C</span></code>, Looking up
and down the hierarchy. Intuitively we will get <code class="docutils literal"><span class="pre">myB.super</span> <span class="pre">==</span> <span class="pre">A:cast(MYB)</span></code> and <code class="docutils literal"><span class="pre">myb</span> <span class="pre">==</span> <span class="pre">B:cast(myB.super)</span></code>.</p>
<p>Of course this works with more than two levels of inheritance. If the casting fails an error occurs.</p>
<p><code class="docutils literal"><span class="pre">C:trycast(x)</span></code> does exactly the same except that this simply returns <code class="docutils literal"><span class="pre">nil</span></code> when the casting is
impossible rather than an error occurs.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="access_modifiers.html" class="btn btn-neutral float-right" title="Encapsulación y modificadores de acceso" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="welcome.html" class="btn btn-neutral" title="Welcome" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Dario Cano.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.01',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>